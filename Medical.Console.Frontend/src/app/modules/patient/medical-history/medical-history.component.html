<div
    class="sm:absolute sm:inset-0 flex flex-col flex-auto min-w-0 sm:overflow-hidden bg-card dark:bg-transparent"
>
    <!-- Header -->
    <div
        class="relative flex flex-col sm:flex-row flex-0 sm:items-center sm:justify-between py-8 px-6 md:px-8 border-b"
    >
        <!-- Title -->
        <div class="text-4xl font-extrabold tracking-tight">
            Historial m√©dico
        </div>
        <!-- Title -->

        <!-- Button -->
        <div class="flex flex-shrink-0 items-center mt-6 sm:mt-0 sm:ml-4">
            <mat-form-field
                *ngIf="canManage"
                class="fuse-mat-dense fuse-mat-no-subscript fuse-mat-rounded min-w-64"
            >
                <mat-select
                    (selectionChange)="onPatientSelected($event)"
                    (openedChange)="patientsFilterControl.onClearFilter()"
                >
                    <select-filter
                        #patientsFilterControl
                        placeholderLabel="Buscar..."
                        (searchValueOutput)="onFilterPatients($event)"
                    ></select-filter>

                    <mat-option
                        disabled
                        *ngIf="!isLoadingPatients && !patients?.length"
                    >
                        No existen resultados
                    </mat-option>

                    <mat-option
                        *ngFor="let p of patients"
                        [value]="p?.displayName"
                    >
                        {{ p?.displayName }}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <button
                class="ml-4"
                mat-flat-button
                *ngIf="canManage"
                [color]="'primary'"
                [routerLink]="['/paciente/historial', 'nueva-cita']"
            >
                <mat-icon [svgIcon]="'heroicons_outline:plus'"></mat-icon>
                <span class="ml-2 mr-1">Nueva cita</span>
            </button>

            <div *ngIf="canManage" class="flex flex-wrap ml-2 mt-2">
                <ng-container>
                    <a
                        [class.cursor-not-allowed]="
                            loadingExport || !selectedPatient
                        "
                        [class.bg-gray-300]="loadingExport"
                        (click)="
                            !loadingExport && selectedPatient && onExportData()
                        "
                        class="flex flex-col w-18 h-18 m-2 p-4 rounded-2xl cursor-pointer bg-card"
                    >
                        <div class="aspect-w-9 aspect-h-6">
                            <div class="flex items-center justify-center">
                                <!-- Icons -->
                                <div class="relative">
                                    <mat-icon
                                        class="icon-size-14 text-hint"
                                        [svgIcon]="'iconsmind:file'"
                                    ></mat-icon>
                                    <div
                                        class="absolute left-0 bottom-0 px-1.5 rounded text-sm font-semibold leading-5 text-white bg-green-600"
                                    >
                                        XLSX
                                    </div>
                                </div>
                            </div>
                        </div>
                    </a>
                </ng-container>
            </div>
        </div>
        <!-- /Button -->
    </div>
    <!-- /Header -->

    <!-- Main -->
    <div class="flex flex-auto overflow-hidden">
        <div
            class="flex flex-col flex-auto sm:mb-18 overflow-hidden sm:overflow-y-auto"
        >
            <history-log></history-log>
        </div>
    </div>
    <!-- /Main -->
</div>
